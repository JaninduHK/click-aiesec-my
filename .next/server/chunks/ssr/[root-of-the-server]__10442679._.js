module.exports=[93695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},50645,a=>{a.n(a.i(27572))},17537,a=>{a.n(a.i(3363))},13718,a=>{a.n(a.i(85523))},18198,a=>{a.n(a.i(45518))},62212,a=>{a.n(a.i(66114))},15843,a=>{a.n(a.i(18357))},53114,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/components/Dashboard/CopyButton.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/Dashboard/CopyButton.tsx <module evaluation>","default");a.s(["default",0,b])},61119,a=>{"use strict";let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/components/Dashboard/CopyButton.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/Dashboard/CopyButton.tsx","default");a.s(["default",0,b])},8282,a=>{"use strict";a.i(53114);var b=a.i(61119);a.n(b)},51769,a=>a.a(async(b,c)=>{try{var d=a.i(7997);a.i(70396);var e=a.i(73727),f=a.i(95936),g=a.i(20971),h=a.i(27659),i=a.i(26911),j=a.i(8282),k=b([h,i]);[h,i]=k.then?(await k)():k;let m=process.env.NEXT_PUBLIC_SHORT_DOMAIN||"https://click.aiesec.my";async function l({params:a}){let b=await a,c=await (0,g.getServerSession)(i.authOptions);c?.user?.id||(0,e.redirect)("/signin");let k=await h.prisma.shortLink.findUnique({where:{id:b.id},include:{user:{select:{id:!0,email:!0,name:!0}}}});k||(0,e.redirect)("/dashboard");let l="ADMIN"===c.user.role;l||k.userId===c.user.id||(0,e.redirect)("/dashboard");let o=new Date,p=new Date(o.getTime()-2592e6),q=new Date(o.getTime()-864e5),r=new Date(o.getTime()-6048e5),[s,t]=await Promise.all([h.prisma.clickEvent.findMany({where:{shortLinkId:k.id,createdAt:{gte:p}},orderBy:{createdAt:"desc"},take:500}),h.prisma.clickEvent.count({where:{shortLinkId:k.id}})]),u=0,v=0,w={},x={},y={};s.forEach(a=>{a.createdAt>=q&&(u+=1),a.createdAt>=r&&(v+=1);let b=a.createdAt.toISOString().slice(0,10);if(w[b]=(w[b]??0)+1,a.referer)try{let b=new URL(a.referer).hostname||a.referer;x[b]=(x[b]??0)+1}catch{x[a.referer]=(x[a.referer]??0)+1}else x["Direct / None"]=(x["Direct / None"]??0)+1;let c=a.country||"Unknown";y[c]=(y[c]??0)+1});let z=Object.entries(w).sort((a,b)=>a[0].localeCompare(b[0])),A=z.length>0?Math.max(...z.map(([,a])=>a)):1,B=Object.entries(x).sort((a,b)=>b[1]-a[1]).slice(0,6),C=Object.entries(y).sort((a,b)=>b[1]-a[1]).slice(0,6);return(0,d.jsxs)("section",{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"flex flex-col gap-3 rounded-2xl border border-stroke bg-white p-6 shadow-sm dark:border-dark-3 dark:bg-dark-2",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm uppercase tracking-wide text-primary",children:"Link analytics"}),(0,d.jsx)("h1",{className:"text-2xl font-bold text-dark dark:text-white",children:k.title||"Untitled link"}),(0,d.jsxs)("p",{className:"text-body-secondary text-sm",children:[m.replace(/\/$/,""),"/",k.slug]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(j.default,{value:`${m.replace(/\/$/,"")}/${k.slug}`,label:"Copy link"}),(0,d.jsx)(f.default,{href:"/dashboard",className:"rounded-lg border border-stroke px-3 py-2 text-xs font-semibold hover:border-primary hover:text-primary dark:border-dark-3 dark:hover:border-primary",children:"Back to dashboard"})]})]}),(0,d.jsxs)("div",{className:"flex flex-wrap items-center gap-3 text-sm text-body-secondary",children:[(0,d.jsxs)("span",{children:["Destination:"," ",(0,d.jsx)("a",{href:k.destination,target:"_blank",className:"text-primary underline",rel:"noreferrer",children:k.destination})]}),l&&k.user?.email&&(0,d.jsxs)("span",{className:"rounded-full bg-slate-200 px-3 py-1 text-xs text-slate-800 dark:bg-dark-3 dark:text-white",children:["Owner: ",k.user.email]})]})]}),(0,d.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,d.jsx)(n,{label:"All-time clicks",value:t}),(0,d.jsx)(n,{label:"Clicks (24h)",value:u}),(0,d.jsx)(n,{label:"Clicks (7 days)",value:v}),(0,d.jsx)(n,{label:"Tracked events (30 days)",value:s.length})]}),(0,d.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[(0,d.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,d.jsxs)("div",{className:"rounded-2xl border border-stroke bg-white p-6 shadow-sm dark:border-dark-3 dark:bg-dark-2",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("p",{className:"text-lg font-semibold text-dark dark:text-white",children:"Daily clicks (last 30 days)"}),(0,d.jsxs)("span",{className:"text-xs text-body-secondary",children:[z.length," days of activity"]})]}),(0,d.jsxs)("div",{className:"mt-4 space-y-2",children:[0===z.length&&(0,d.jsx)("p",{className:"text-sm text-body-secondary",children:"No clicks captured yet. Share your short link to start seeing data."}),z.map(([a,b])=>(0,d.jsxs)("div",{className:"flex items-center gap-3 text-sm text-body-secondary",children:[(0,d.jsx)("span",{className:"w-24",children:a}),(0,d.jsx)("div",{className:"h-2 flex-1 rounded-full bg-slate-200 dark:bg-dark-3",children:(0,d.jsx)("div",{className:"h-2 rounded-full bg-primary",style:{width:`${b/A*100}%`}})}),(0,d.jsx)("span",{className:"w-10 text-right text-dark dark:text-white",children:b})]},a))]})]}),(0,d.jsxs)("div",{className:"rounded-2xl border border-stroke bg-white p-6 shadow-sm dark:border-dark-3 dark:bg-dark-2",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("p",{className:"text-lg font-semibold text-dark dark:text-white",children:"Recent clicks"}),(0,d.jsx)("span",{className:"text-xs text-body-secondary",children:"Showing up to 20 latest events"})]}),(0,d.jsx)("div",{className:"mt-3 overflow-x-auto",children:(0,d.jsxs)("table",{className:"min-w-full text-left text-sm",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{className:"border-b border-stroke text-body-secondary dark:border-dark-3",children:[(0,d.jsx)("th",{className:"px-2 py-3",children:"Time"}),(0,d.jsx)("th",{className:"px-2 py-3",children:"Referrer"}),(0,d.jsx)("th",{className:"px-2 py-3",children:"Country"}),(0,d.jsx)("th",{className:"px-2 py-3",children:"IP (last octet hidden)"})]})}),(0,d.jsxs)("tbody",{className:"divide-y divide-stroke dark:divide-dark-3",children:[0===s.length&&(0,d.jsx)("tr",{children:(0,d.jsx)("td",{colSpan:4,className:"px-2 py-4 text-center text-body-secondary",children:"No clicks yet."})}),s.slice(0,20).map(a=>(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{className:"px-2 py-2 text-body-secondary",children:new Intl.DateTimeFormat("en",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(a.createdAt))}),(0,d.jsx)("td",{className:"px-2 py-2 text-body-secondary",children:a.referer||"Direct"}),(0,d.jsx)("td",{className:"px-2 py-2 text-body-secondary",children:a.country||"Unknown"}),(0,d.jsx)("td",{className:"px-2 py-2 text-body-secondary",children:a.ip?a.ip.replace(/\.\d+$/,".xxx"):"â€”"})]},a.id))]})]})})]})]}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"rounded-2xl border border-stroke bg-white p-6 shadow-sm dark:border-dark-3 dark:bg-dark-2",children:[(0,d.jsx)("p",{className:"text-lg font-semibold text-dark dark:text-white",children:"Top referrers"}),(0,d.jsxs)("div",{className:"mt-3 space-y-2",children:[0===B.length&&(0,d.jsx)("p",{className:"text-sm text-body-secondary",children:"No referrer data yet."}),B.map(([a,b])=>(0,d.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-stroke px-3 py-2 text-sm text-body-secondary dark:border-dark-3",children:[(0,d.jsx)("span",{className:"truncate",children:a}),(0,d.jsx)("span",{className:"text-dark dark:text-white",children:b})]},a))]})]}),(0,d.jsxs)("div",{className:"rounded-2xl border border-stroke bg-white p-6 shadow-sm dark:border-dark-3 dark:bg-dark-2",children:[(0,d.jsx)("p",{className:"text-lg font-semibold text-dark dark:text-white",children:"Countries"}),(0,d.jsxs)("div",{className:"mt-3 space-y-2",children:[0===C.length&&(0,d.jsx)("p",{className:"text-sm text-body-secondary",children:"No country data yet."}),C.map(([a,b])=>(0,d.jsxs)("div",{className:"flex items-center justify-between rounded-lg border border-stroke px-3 py-2 text-sm text-body-secondary dark:border-dark-3",children:[(0,d.jsx)("span",{children:a}),(0,d.jsx)("span",{className:"text-dark dark:text-white",children:b})]},a))]})]})]})]})]})}let n=({label:a,value:b})=>(0,d.jsxs)("div",{className:"rounded-xl border border-stroke bg-white p-4 shadow-sm dark:border-dark-3 dark:bg-dark-2",children:[(0,d.jsx)("p",{className:"text-sm text-body-secondary",children:a}),(0,d.jsx)("p",{className:"text-3xl font-semibold text-dark dark:text-white",children:b})]});a.s(["default",()=>l,"metadata",0,{title:"Link analytics",description:"Detailed analytics for a short link."}]),c()}catch(a){c(a)}},!1)];

//# sourceMappingURL=%5Broot-of-the-server%5D__10442679._.js.map